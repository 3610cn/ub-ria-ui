<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>RichSelectors - ESUI Demo</title>
    <link rel="stylesheet" href="assets/themes/standard.css" />
    <link href="assets/third-party/prism.css" rel="stylesheet" />
    <!--[if lt IE 9]>
    <link rel="stylesheet" href="assets/ie8.css" />
    <![endif]-->
    <link rel="stylesheet" href="assets/google-code-prettify/prettify.css" />
    <script src="assets/loader/esl.js"></script>
    <script src="assets/third-party/jquery-1.9.1.min.js"></script>
    <script src="assets/google-code-prettify/prettify.js"></script>
    <script src="demo.js"></script>
</head>
<body>
    <h1 id="branding">ESUI - RichSelectors</h1>
    <div id="page">
        <ul id="navigator">
        </ul>
        <div id="main">
            <h2>单一选择Table Selector</h2>
            <div class="view">
                <ul class="viewer">
                    <li class="view-markup">结构</li>
                </ul>
                <div class="example ui-demo-light-stage">
                    <div class="row">
                        <h3>单一选择Table Selector</h3>
                        <div
                            data-ui-type="RichSelectorGroup"
                            data-ui-id="single-slots"
                            data-ui-name="single-slots">
                            <div
                                data-ui-type="TableRichSelector"
                                data-ui-role="source"
                                data-ui-title="全部有效"
                                data-ui-has-head="true"
                                data-ui-has-search-box="true"
                                data-ui-need-batch-action="true"
                                data-ui-allow-unselect-node="true"
                                data-ui-states='no-hover-icon'
                                data-ui-batch-action-label="选择全部">
                            </div>
                        </div>
                    </div>
                    <div data-ui-id="get-single-slots" data-ui-type="Button">获取选值</div>
                    <label data-ui-id="single-slots-result" data-ui-type="Label"></label>
                </div>
            </div>

            <h2>左右选择Table Selector</h2>
            <div class="intro">
                <p>右两个列表型富选择器组成，支持从左侧添加到右侧，支持从右侧删除。</p>
            </div>
            <div class="view">
                <ul class="viewer">
                    <li class="view-markup">结构</li>
                </ul>
                <div class="example ui-demo-light-stage">
                    <div class="row">
                        <h3>双向Table Rich Selector</h3>
                        <div
                            data-ui-type="RichSelectorGroup"
                            data-ui-id="cas-slots"
                            data-ui-name="cas-slots">
                            <div
                                data-ui-type="TableRichSelector"
                                data-ui-role="source"
                                data-ui-title="全部有效"
                                data-ui-has-head="true"
                                data-ui-has-search-box="true"
                                data-ui-need-batch-action="true"
                                data-ui-allow-unselect-node="true"
                                data-ui-batch-action-label="选择全部">
                            </div>
                            <div
                                data-ui-type="TableRichSelector"
                                data-ui-role="target"
                                data-ui-title="已选择"
                                data-ui-mode="delete"
                                data-ui-need-batch-action="true"
                                data-ui-batch-action-label="删除全部"
                                data-ui-empty-text="请从左侧选择要添加的">
                            </div>
                        </div>
                    </div>
                    <div data-ui-type="Button" data-ui-id="get-cas-slots">获取选值</div>
                    <label data-ui-type="Label" data-ui-id="cas-slots-result"></label>
                </div>
            </div>

            <h2>左右选择Tree Selector</h2>
            <div class="intro">
                <p>右两个树表型富选择器组成，支持从左侧添加到右侧，支持从右侧删除。</p>
            </div>
            <div class="view">
                <ul class="viewer">
                    <li class="view-markup">结构</li>
                </ul>
                <div class="example ui-demo-light-stage">
                    <div class="row">
                        <h3>双向Tree Rich Selector</h3>
                        <div
                            data-ui-type="RichSelectorGroup"
                            data-ui-id="cas-apps"
                            data-ui-name="cas-apps">
                            <div data-ui-type="TreeRichSelector"
                                data-ui-role="source"
                                data-ui-title="全部有效"
                                data-ui-hold-state="true"
                                data-ui-has-foot="false"
                                data-ui-only-leaf-select="false"
                                data-ui-need-batch-action="true"
                                data-ui-allow-unselect-node="true"
                                data-ui-batch-action-label="选择全部">
                            </div>
                            <div data-ui-type="TreeRichSelector"
                                data-ui-role="target"
                                data-ui-mode="delete"
                                data-ui-has-search-box="false"
                                data-ui-title="已分配"
                                data-ui-empty-text="请从左侧选择要添加的"
                                data-ui-has-foot="false"
                                data-ui-need-batch-action="true"
                                data-ui-batch-action-label="删除全部"
                                data-ui-hold-state="true"
                                data-ui-only-leaf-select="false"
                                data-ui-validity-label="slot-validity">
                            </div>
                        </div>
                    </div>
                    <div data-ui-type="Button" data-ui-id="get-cas-apps">获取选值</div>
                    <label data-ui-type="Label" data-ui-id="cas-apps-result"></label>
                </div>
            </div>

            <h2>三联动过滤列表Selector组合</h2>
            <div class="intro">
            </div>
            <div class="view">
                <ul class="viewer">
                    <li class="view-markup">结构</li>
                </ul>
                <div class="example ui-demo-light-stage ui-small">
                    <div class="row">
                        <h3>三联动过滤列表Selector组合</h3>
                            <div data-ui-type="FilterRichSelectorGroup"
                                data-ui-id="delivery-under-order">
                                <div
                                    data-ui-type="TableRichSelectorWithFilter"
                                    data-ui-role="filter"
                                    data-ui-title="订单"
                                    data-ui-has-head="false"
                                    data-ui-has-search-box="true"
                                    data-ui-need-batch-action="false"
                                    data-ui-has-row-head="true"
                                    data-ui-multi="false"
                                    data-ui-mode="load">
                                </div>
                                <div
                                    data-ui-type="TableRichSelectorWithFilter"
                                    data-ui-role="source"
                                    data-ui-title="广告"
                                    data-ui-mode="add"
                                    data-ui-has-head="false"
                                    data-ui-has-row-head="false"
                                    data-ui-multi="true"
                                    data-ui-need-batch-action="false"
                                    data-ui-empty-text="请从左侧选择要订单">
                                </div>
                                <div
                                    data-ui-type="TableRichSelectorWithFilter"
                                    data-ui-role="target"
                                    data-ui-title="广告"
                                    data-ui-mode="delete"
                                    data-ui-has-head="false"
                                    data-ui-has-row-head="false"
                                    data-ui-need-batch-action="false"
                                    data-ui-empty-text="请从左侧选择要广告">
                                </div>
                            </div>
                        </h3>
                    </div>
                    <div data-ui-type="Button" data-ui-id="get-deliveries">获取选值</div>
                    <label data-ui-type="Label" data-ui-id="deliveries-result"></label>
                </div>
            </div>
        </div>
    </div>
    <script>
        require(
                [
                    'esui',
                    'selectors/RichSelectorGroup',
                    'selectors/TableRichSelector',
                    'selectors/TableRichSelectorWithFilter',
                    'selectors/TreeRichSelector',
                    'selectors/FilterRichSelectorGroup'
                ],
                function (ui) {
                    ui.init();
                    var arrayDatasource = [];
                    for (var i = 0; i < 20; i++) {
                        arrayDatasource.push({
                            text: '选项' + (i + 1),
                            name: '选项' + (i + 1),
                            prop: '属性' + (i + 1),
                            id: i + 1
                        })
                    }

                    var single = ui.get('single-slots');
                    var singleSource = single.source;
                    singleSource.setProperties({
                        datasource: arrayDatasource,
                        fields: [
                            {
                                field: 'name',
                                content: function (item) {
                                    return item.name;
                                },
                                searchScope: 'partial',
                                width: 200,
                                isDefaultSearchField: true,
                                title: '名称'
                            }
                        ]
                    });

                    ui.get('get-single-slots').on('click', function () {
                        ui.get('single-slots-result').setText(single.getValue());
                    });

                    var cascading = ui.get('cas-slots');
                    var casSource = cascading.source;
                    var casTarget = cascading.target;

                    casSource.setProperties({
                        datasource: arrayDatasource,
                        fields: [
                            {
                                field: 'name',
                                content: function (item) {
                                    return item.name;
                                },
                                searchScope: 'partial',
                                width: 100,
                                isDefaultSearchField: true,
                                title: '名称'
                            },
                            {
                                field: 'value',
                                content: function (item) {
                                    return item.prop;
                                },
                                width: 35,
                                title: '值'
                            }
                        ]
                    });
                    casTarget.setProperties({
                        fields: [
                            {
                                field: 'name',
                                content: function (item) {
                                    return item.name;
                                },
                                isDefaultSearchField: true,
                                searchScope: 'partial',
                                width: 120,
                                title: '名称'
                            },
                            {
                                field: 'value',
                                content: function (item) {
                                    return item.prop;
                                },
                                width: 35,
                                title: '值'
                            }
                        ]
                    });

                    ui.get('get-cas-slots').on('click', function () {
                        ui.get('cas-slots-result').setText(cascading.getValue());
                    });

                    var treeDatasource = {
                        id: '0',
                        text: '所有选项',
                        children: []
                    };
                    var children = treeDatasource.children;
                    for (var i = 0; i < 2; i++) {
                        children.push({
                            text: '选项' + (i + 1),
                            name: '选项' + (i + 1),
                            id: i + 1
                        })
                    }

                    for (i = 0; i < children.length; i++) {
                        var node = children[i];
                        node.children = [
                            {
                                text: '子节点' + i + 1,
                                name: '子节点' + i + 1,
                                id: (i + 1) * 100 + 1,
                                isSelected: true
                            },
                            {
                                text: '子节点' + i + 2,
                                name: '子节点' + i + 2,
                                id: (i + 1) * 100 + 2
                            }
                        ]
                    }

                    var appTree = ui.get('cas-apps');
                    var leftTree = appTree.source;
                    var rightTree = appTree.target;
                    leftTree.setProperties({datasource: treeDatasource});
                    var treeData = leftTree.getSelectedTree();
                    rightTree.setProperties({datasource: treeData});


                    ui.get('get-cas-apps').on('click', function () {
                        ui.get('cas-apps-result').setText(appTree.getValue());
                    });


                    var arrayDatasource2 = [];
                    for (var i = 0; i < 20; i++) {
                        var isSelected = false;
                        if (i == 20) {
                            isSelected = true;
                        }
                        arrayDatasource2.push({
                            text: '<input />选项' + (i + 1),
                            name: '<input />选项' + (i + 1),
                            status: i % 2 + '',
                            id: i + 1,
                            isSelected: isSelected
                        })
                    }
                    var deliveryUnderOrder = ui.get('delivery-under-order');

                    var order = deliveryUnderOrder.filter;
                    var delivery = deliveryUnderOrder.source;
                    var result =  deliveryUnderOrder.target;

                    order.setProperties({
                        datasource: arrayDatasource2,
                        fields: [
                            {
                                field: 'name',
                                content: 'name',
                                searchScope: 'partial',
                                width: 100,
                                isDefaultSearchField: true,
                                title: '名称'
                            },
                            {
                                field: 'status',
                                content: function (item) {
                                    return '' + item.status;
                                },
                                searchScope: 'full',
                                width: 70,
                                isDefaultSearchField: true,
                                title: '状态'
                            }
                        ],
                        filterField: 'status',
                        filterDatasource: [
                            {
                                value: '',
                                text: '全部'
                            },
                            {
                                value: 1,
                                text: 1
                            },
                            {
                                value: 2,
                                text: 2
                            },
                            {
                                value: 3,
                                text: 3
                            }
                        ]
                    });

                    result.setProperties({
                        datasource: [
                            {id: 1, name: '<input />选项1'},
                            {id: 6, name: '<input />选项6'},
                            {id: 14, name: '<input />选项14'}
                        ]
                    });

                    deliveryUnderOrder.on('load', function (e) {
                        e.data = arrayDatasource2.slice(e.item.id);
                    });


                    ui.get('get-deliveries').on('click', function () {
                        ui.get('deliveries-result').setText(deliveryUnderOrder.getValue());
                    });

                }
        );
        copyExample();
    </script>
</body>
</html>
